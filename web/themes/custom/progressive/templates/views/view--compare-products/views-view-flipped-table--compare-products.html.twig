{#
/**
 * @file
 * Template to display a view as a table with rows and columns flipped.
 *
 * @see template_preprocess_views_flipped_table()
 *
 * @ingroup themeable
 */
#}
{%
  set classes = [
    'cols-' ~ flipped_header|length,
    responsive ? 'responsive-enabled',
    sticky ? 'sticky-enabled',
    'c-product-compare-table',
    'views-table',
    'table-bordered',
    'table'
  ]
%}

<div class="view view-compare-products">
  <table{{ attributes.addClass(classes).setAttribute('id', 'compare-table') }} summary="{{ summary }}">
    {% if first_row_header %}
      <thead>

      {#Remove from Compare#}
      <tr class="remove">
        <td></td>
        {% for index, item in rows_flipped['link_flag']['columns'] %}
          {% set data_class = 'data-index-' ~ index %}
          <td{{ create_attribute().addClass(data_class) }}>
            {% for content in item.content %}
              <span class="compare-flag hidden">
              {{ content.field_output }}
            </span>
              <a href="#" class="product-remove" data-index="{{ index }}">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="16px" height="16px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                  <g>
                    <path fill="#7f7f7f" d="M6,13c0.553,0,1-0.447,1-1V7c0-0.553-0.447-1-1-1S5,6.447,5,7v5C5,12.553,5.447,13,6,13z"></path>
                    <path fill="#7f7f7f" d="M10,13c0.553,0,1-0.447,1-1V7c0-0.553-0.447-1-1-1S9,6.447,9,7v5C9,12.553,9.447,13,10,13z"></path>
                    <path fill="#7f7f7f" d="M14,3h-1V1c0-0.552-0.447-1-1-1H4C3.448,0,3,0.448,3,1v2H2C1.447,3,1,3.447,1,4s0.447,1,1,1c0,0.273,0,8.727,0,9c0,1.104,0.896,2,2,2h8c1.104,0,2-0.896,2-2c0-0.273,0-8.727,0-9c0.553,0,1-0.447,1-1S14.553,3,14,3z M5,2h6v1H5V2z M12,14H4V5h8V14z"></path>
                  </g>
                </svg>
              </a>
            {% endfor %}
          </td>
        {% endfor %}
      </tr>

      <tr>
        {% if header[flipped_header_field_name].default_classes %}
          {% set
            column_classes = [
              'views-field',
              'views-field-' ~ flipped_header_field_name,
              'first'
            ]
          %}
        {% endif %}

        <th{{ header[flipped_header_field_name].attributes.addClass(column_classes) }}>
          {{ header[flipped_header_field_name].content }}
        </th>
        {% for key, column in flipped_header %}
          {% for field in column.fields %}
            {% set column_classes = ['views-field']|merge(['views-field-' ~ field, 'data-index-' ~ key]) %}
          {% endfor %}
          <th{{ column.attributes.addClass(column_classes) }}>
            {%- if column.wrapper_element -%}
              <{{ column.wrapper_element }}>
            {%- endif -%}

            {%- if column.url -%}
              <a href="{{ column.url }}" title="{{ column.title }}">{{ column.content }}{{ column.sort_indicator }}</a>
            {%- else -%}
              {{ column.content }}{{ column.sort_indicator }}
            {%- endif -%}

            {%- if column.wrapper_element -%}
              </{{ column.wrapper_element }}>
            {%- endif -%}
          </th>
        {% endfor %}
      </tr>
      </thead>
    {% endif %}

    <tbody>
    {% for field_name, row in rows_flipped|without('title', 'field_old_price', 'link_flag') %}
      <tr>
        {% if header[field_name] %}
          {% set header_column = header[field_name] %}
          {%
            set column_classes = [
              'views-field',
              'views-field-' ~ field_name,
              'first',
            ]
          %}
          <td{{ header_column.attributes.addClass(column_classes) }}>
            <strong>
              {%- if header_column.url -%}
                <a href="{{ header_column.url }}" title="{{ header_column.title }}">{{ header_column.content }}{{ header_column.sort_indicator }}</a>
              {%- else -%}
                {{ header_column.content }}{{ header_column.sort_indicator }}
              {%- endif -%}
            </strong>
          </td>
        {% endif %}

        {% for index, item in row.columns %}
          {%
            set column_classes = [
              'views-field',
              'data-index-' ~ index,
              field_name == 'price__number' ? 'cell-align-center'
            ]
          %}
          {% for field in column.fields %}
            {% set column_classes = column_classes|merge(['views-field-' ~ field]) %}
          {% endfor %}
          <td{{ item.attributes.addClass(column_classes) }}>
            {% for content in item.content %}
              {% if field_name == 'price__number' %}
                {{ rows_flipped['field_old_price']['columns'][index]['content'] }}
                <span class="uc-price">
              {% endif %}
                {{ content.field_output }}
              {% if field_name == 'price__number' %} </span> {% endif %}
            {% endfor %}
          </td>
        {% endfor %}
      </tr>
    {% endfor %}

    {#Remove from Compare#}
    <tr class="remove remove-bottom">
      <td></td>
      {% for index, item in rows_flipped['link_flag']['columns'] %}
        {% set data_class = 'data-index-' ~ index %}
        <td{{ create_attribute().addClass(data_class) }}>
          {% for content in item.content %}
            <span class="compare-flag hidden">
              {{ content.field_output }}
            </span>
            <a href="#" class="product-remove" data-index="{{ index }}">
              <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="16px" height="16px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <g>
                  <path fill="#7f7f7f" d="M6,13c0.553,0,1-0.447,1-1V7c0-0.553-0.447-1-1-1S5,6.447,5,7v5C5,12.553,5.447,13,6,13z"></path>
                  <path fill="#7f7f7f" d="M10,13c0.553,0,1-0.447,1-1V7c0-0.553-0.447-1-1-1S9,6.447,9,7v5C9,12.553,9.447,13,10,13z"></path>
                  <path fill="#7f7f7f" d="M14,3h-1V1c0-0.552-0.447-1-1-1H4C3.448,0,3,0.448,3,1v2H2C1.447,3,1,3.447,1,4s0.447,1,1,1
              c0,0.273,0,8.727,0,9c0,1.104,0.896,2,2,2h8c1.104,0,2-0.896,2-2c0-0.273,0-8.727,0-9c0.553,0,1-0.447,1-1S14.553,3,14,3z M5,2h6v1
              H5V2z M12,14H4V5h8V14z"></path>
                 </g>
              </svg>
            </a>
          {% endfor %}
        </td>
      {% endfor %}
    </tr>

    </tbody>
  </table>
</div>
